ðŸ“˜ Pattern 01 â€“ Total Revenue per Customer (Last 12 Months)
ðŸ” Objective
Calculate the total revenue generated by each customer in the last 12 months, based on their invoice data.

ðŸ§  Skills Covered
Aggregations (SUM)
JOIN across multiple tables
Filtering by date
Grouping and ordering

ðŸ§¾ Problem Statement
Find the total sales revenue for each customer in the last 12 months using invoice data. Include customer ID, customer name, and total revenue. Sort the results by revenue in descending order.

ðŸ§± Tables Used
Sales.Invoices

Sales.InvoiceLines

Sales.Customers

ðŸ§® SQL Query

SELECT 
  c.CustomerID, 
  c.CustomerName, 
  SUM(ic.ExtendedPrice) AS Total_Revenue  
FROM sales.Invoices i
INNER JOIN sales.InvoiceLines ic
  ON i.InvoiceID = ic.InvoiceID
INNER JOIN sales.Customers c
  ON i.CustomerID = c.CustomerID
WHERE i.InvoiceDate >= DATEADD(YEAR, -1, GETDATE())
GROUP BY c.CustomerID, c.CustomerName
ORDER BY Total_Revenue DESC;

ðŸ“Š Sample Output
CustomerID	CustomerName	Total_Revenue
105	Contoso Traders	98,500.00
112	Tailspin Toys	76,210.45
123	Northwind Bikes	69,480.20

ðŸŽ¯ Why This Pattern Matters
This is a classic business metric that appears in dashboards, reports, and interviews. It helps identify top customers and revenue concentration, which are key to business growth strategies.
